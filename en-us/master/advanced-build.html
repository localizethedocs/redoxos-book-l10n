<!DOCTYPE HTML>
<html lang="en_US" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Advanced Native Build - The Redox Operating System</title>


        <!-- Custom HTML head -->
        <style>
        .light .redox-logo {
            content: url("assets/redox_light_512.png");
        }
        .rust .redox-logo {
            content: url("assets/redox_light_512.png");
        }
        .coal .redox-logo {
            content: url("assets/redox_dark_512.png");
        }
        .navy .redox-logo {
            content: url("assets/redox_dark_512.png");
        }
        .ayu .redox-logo {
            content: url("assets/redox_dark_512.png");
        }
        </style>
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="This book carefully describes the design, implementation, direction, and structure of Redox, the operating system.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Redox Operating System</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="advanced-build"><a class="header" href="#advanced-build">Advanced Build</a></h1>
<p>In this section, we provide the gory details that may be handy to know if you are contributing to or developing for <strong>Redox</strong>.</p>
<p>Before reading through this section, make sure you have already read:</p>
<ul>
<li><a href="./podman-build.html">Podman Build</a></li>
<li><a href="./building-redox.html">Native Build</a></li>
<li><a href="./build-system-reference.html">Build System Reference</a></li>
</ul>
<h2 id="setup-your-environment"><a class="header" href="#setup-your-environment">Setup Your Environment</a></h2>
<p>Advanced users may accomplish the same as the <a href="https://gitlab.redox-os.org/redox-os/redox/-/blob/master/native_bootstrap.sh"><strong>native_bootstrap.sh</strong></a> script with the following steps:</p>
<ul>
<li><a href="#clone-the-repository">Clone The Repository</a></li>
<li><a href="#install-the-necessary-packages-and-emulators">Install The Necessary Packages</a></li>
<li><a href="#install-rust-stable-and-nightly">Install Rust</a></li>
<li><a href="./configuration-settings.html">Adjust Your Configuration Settings</a></li>
<li>Build the system</li>
</ul>
<h2 id="clone-the-repository"><a class="header" href="#clone-the-repository">Clone The Repository</a></h2>
<ul>
<li>Create a directory and clone the repository</li>
</ul>
<pre><code class="language-sh">mkdir -p ~/tryredox
</code></pre>
<pre><code class="language-sh">cd ~/tryredox
</code></pre>
<pre><code class="language-sh">git clone https://gitlab.redox-os.org/redox-os/redox.git --origin upstream
</code></pre>
<pre><code class="language-sh">cd redox
</code></pre>
<pre><code class="language-sh">make pull
</code></pre>
<p>Please be patient, this can take minutes to hours depending on the hardware and network you're using.</p>
<p>In addition to installing the various packages needed for building Redox, <strong>native_bootstrap.sh</strong> and <strong>podman_bootstrap.sh</strong> both clone the repository, so if you used either script, you have completed Step 1.</p>
<h2 id="install-the-necessary-packages-and-emulator"><a class="header" href="#install-the-necessary-packages-and-emulator">Install The Necessary Packages and Emulator</a></h2>
<p>If you cloned the sources <em>before</em> running <strong>native_bootstrap.sh</strong>, you can use:</p>
<pre><code class="language-sh">cd ~/tryredox/redox
</code></pre>
<pre><code class="language-sh">./native_bootstrap.sh -d
</code></pre>
<p>If you can't use the <code>native_bootstrap.sh</code> script, you need to install at least:</p>
<ul>
<li>Essential compilers: GCC, Rust and Nasm</li>
<li>GNU search, text, and build tools: <code>find</code>, <code>grep</code>, <code>make</code>, <code>patch</code>, <code>pkg-config</code>, and <code>sed</code></li>
<li>Other build tools: <code>autotools</code>, <code>cmake</code>, <code>meson</code>, <code>perl</code> and <code>python3</code></li>
<li>Other file tooling: <code>curl</code>, <code>rsync</code>, <code>tar</code> and <code>wget</code></li>
<li>Libraries to build GCC: <code>gmp</code>, <code>mpfr</code> and <code>mpc</code></li>
<li>Rust tooling: <code>cbindgen</code> and <code>just</code></li>
<li>FUSE (to build an image) and QEMU (to run the image)</li>
</ul>
<p>Additional programs or libraries might be needed to build more packages. You can attempt to install the necessary packages below.</p>
<blockquote>
<p>‚ö†Ô∏è <strong>Warning:</strong> The following commands may be outdated</p>
</blockquote>
<blockquote>
<p>üìù <strong>Note:</strong> Always use the latest stable version of the Linux or Unix-like distribution of your choice, as any outdated tools might result in unexpected build errors. Redox cross-compilation is guaranteed to work reliably only in the current Podman environment, which is Debian 13 (Trixie).</p>
</blockquote>
<h3 id="pop_osubuntudebian-users"><a class="header" href="#pop_osubuntudebian-users">Pop!_OS/Ubuntu/Debian Users</a></h3>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">sudo apt-get install ant autoconf automake autopoint bison \
build-essential clang cmake curl dos2unix doxygen file flex \
fuse3 g++ genisoimage git gperf intltool libexpat-dev libfuse-dev \
libgmp-dev libhtml-parser-perl libjpeg-dev libmpfr-dev libpng-dev \
libsdl1.2-dev libsdl2-ttf-dev libtool llvm lua5.4 m4 make meson nasm \
ninja-build patch perl pkg-config po4a protobuf-compiler python3 \
python3-mako rsync scons texinfo unzip wget xdg-utils xxd zip zstd
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo apt-get install qemu-system-x86 qemu-kvm qemu-system-arm qemu-system-riscv
</code></pre>
<ul>
<li>If you want to use VirtualBox, run:</li>
</ul>
<pre><code class="language-sh">sudo apt-get install virtualbox
</code></pre>
<h3 id="fedora-users"><a class="header" href="#fedora-users">Fedora Users</a></h3>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">sudo dnf install autoconf vim bison flex genisoimage gperf \
glibc-devel.i686 expat expat-devel fuse-devel fuse3-devel gmp-devel \
libpng-devel perl perl-HTML-Parser libtool libjpeg-turbo-devel
SDL2_ttf-devel sdl12-compat-devel m4 nasm po4a syslinux \
texinfo ninja-build meson waf python3-mako make gcc gcc-c++ \
openssl patch automake perl-Pod-Html perl-FindBin gperf curl \
gettext-devel perl-Pod-Xhtml pkgconf-pkg-config cmake llvm zip \
unzip lua luajit make clang doxygen ant protobuf-compiler zstd
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo dnf install qemu-system-x86 qemu-kvm qemu-system-arm qemu-system-riscv
</code></pre>
<ul>
<li>If you want to use VirtualBox, install from the VirtualBox <a href="https://www.virtualbox.org/wiki/Linux_Downloads">Linux Downloads</a> page.</li>
</ul>
<h3 id="arch-linux-users"><a class="header" href="#arch-linux-users">Arch Linux Users</a></h3>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">pacman -S --needed cmake fuse git gperf perl-html-parser nasm \
wget texinfo bison flex po4a autoconf curl file patch automake \
scons waf expat gmp libtool libpng libjpeg-turbo sdl12-compat \
m4 pkgconf po4a syslinux meson python python-mako make xdg-utils \
zip unzip llvm clang perl doxygen lua ant protobuf
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo pacman -S qemu-system-x86 qemu-system-arm qemu-system-riscv
</code></pre>
<ul>
<li>If you want to use VirtualBox, run:</li>
</ul>
<pre><code class="language-sh">sudo pacman -S virtualbox
</code></pre>
<h3 id="opensuse-users"><a class="header" href="#opensuse-users">OpenSUSE Users</a></h3>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">sudo zypper install gcc gcc-c++ glibc-devel-32bit nasm make fuse-devel \
cmake openssl automake gettext-tools libtool po4a patch flex gperf autoconf \
bison curl wget file libexpat-devel gmp-devel libpng16-devel libjpeg8-devel \
perl perl-HTML-Parser m4 patch scons pkgconf syslinux-utils ninja meson python-Mako \
xdg-utils zip unzip llvm clang doxygen lua54 ant protobuf
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo zypper install qemu-x86 qemu-kvm
</code></pre>
<h3 id="gentoo-users"><a class="header" href="#gentoo-users">Gentoo Users</a></h3>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">sudo emerge dev-lang/nasm dev-vcs/git sys-fs/fuse
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo emerge app-emulation/qemu
</code></pre>
<ul>
<li>If you want to use VirtualBox, install from the VirtualBox <a href="https://www.virtualbox.org/wiki/Linux_Downloads">Linux Downloads</a> page.</li>
</ul>
<h3 id="gnu-guix-users"><a class="header" href="#gnu-guix-users">GNU Guix Users</a></h3>
<p>Rust nightly isn't packaged in Guix currently, so you need a
FHS-enabled container to use rustup:</p>
<pre><code class="language-sh">guix shell --pure --container --emulate-fhs --network --share=$HOME \
  coreutils bash curl grep gcc-toolchain@14.3.0 nss-certs \
  -- bash -c 'curl --proto "=https" --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain nightly'

guix shell --pure --container --emulate-fhs --network --share=$HOME \
  coreutils bash gcc-toolchain@14.3.0 nss-certs zlib glibc \
  -- bash -c 'export LD_LIBRARY_PATH=$(dirname $(gcc -print-file-name=libgcc_s.so.1)):$LD_LIBRARY_PATH &amp;&amp; source ~/.cargo/env &amp;&amp; cargo install cbindgen'
</code></pre>
<p>Then you will be able to run the actual build except for the part that
uses FUSE to build the root filesystem. Modify <code>tryredox/redox</code> in the
command below to match where your sources are:</p>
<pre><code class="language-sh">guix shell --pure --container --emulate-fhs --network --share=$HOME \
  coreutils bash curl wget gcc-toolchain@14.3.0 pkg-config fuse nss-certs zlib \
  grep make which findutils sed gawk diffutils tar gzip perl git git-lfs \
  binutils nasm just m4 patch autoconf automake help2man texinfo xz \
  bzip2 mpfr gmp file ncurses readline flex bison python ninja cmake \
  -- bash -c '
export LD_LIBRARY_PATH="/lib64:/lib:$LD_LIBRARY_PATH"
export CI=1
source ~/.cargo/env
cd ~/tryredox/redox
make all PODMAN_BUILD=0 REPO_BINARY=1
'
</code></pre>
<p>The FUSE portion needs to run outside of a Guix shell container. To
do that, we will patch the Rust executables so they can find
<code>libgcc_s.so.1</code> under <code>/gnu/store</code> instead of <code>/lib</code> :</p>
<pre><code class="language-sh">LIBGCC_DIR=$(guix shell --container --emulate-fhs gcc-toolchain bash coreutils \
  -- bash -c 'dirname $(readlink -f /lib64/libgcc_s.so.1)')
</code></pre>
<pre><code class="language-sh">guix shell patchelf -- patchelf --set-rpath "$LIBGCC_DIR" build/fstools/bin/redox_installer
</code></pre>
<pre><code class="language-sh">guix shell patchelf -- patchelf --set-rpath "$LIBGCC_DIR" build/fstools/bin/redoxfs
</code></pre>
<pre><code class="language-sh">guix shell patchelf -- patchelf --set-rpath "$LIBGCC_DIR" build/fstools/bin/redoxfs-mkfs
</code></pre>
<p>Finally, you can run the image building part outside of a container
so that FUSE works and launch qemu:</p>
<pre><code class="language-sh">guix shell make just nasm qemu -- make qemu PODMAN_BUILD=0
</code></pre>
<h3 id="freebsd-users"><a class="header" href="#freebsd-users">FreeBSD Users</a></h3>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">sudo pkg install coreutils findutils gcc nasm pkgconf fusefs-libs3 \
cmake gmake wget openssl texinfo python automake gettext bison gperf \
autoconf curl file flex expat2 gmp png libjpeg-turbo sdl12 sdl2_ttf \
perl5.36 p5-HTML-Parser libtool m4 po4a syslinux ninja meson xdg-utils \
zip unzip llvm doxygen patch automake scons lua54 py-protobuf-compiler
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo pkg install qemu qemu-system-x86_64
</code></pre>
<ul>
<li>If you want to use VirtualBox, run:</li>
</ul>
<pre><code class="language-sh">sudo pkg install virtualbox
</code></pre>
<h3 id="macos-users"><a class="header" href="#macos-users">MacOS Users</a></h3>
<p>Please read the MacOS warning in <a href="./advanced-podman-build.html#macos">Advanced Podman Build</a>. We recommend you to use the Podman Build if you insist on using MacOS.</p>
<h4 id="macports"><a class="header" href="#macports">MacPorts</a></h4>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">sudo port install coreutils findutils gcc49 gcc-4.9 nasm pkgconfig \
osxfuse x86_64-elf-gcc cmake ninja po4a findutils texinfo autoconf \
openssl3 openssl11 bison curl wget file flex gperf expat gmp libpng \
jpeg libsdl12 libsdl2_ttf libtool m4 ninja meson python311 py37-mako \
xdg-utils zip unzip llvm-16 clang-16 perl5.24 p5-html-parser doxygen \
gpatch automake scons gmake lua protobuf-c
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">sudo port install qemu qemu-system-x86_64
</code></pre>
<ul>
<li>If you want to use VirtualBox, run:</li>
</ul>
<pre><code class="language-sh">sudo port install virtualbox
</code></pre>
<p>If you have some problem, try to install this Perl module:</p>
<pre><code class="language-sh">cpan install HTML::Entities
</code></pre>
<h4 id="homebrew"><a class="header" href="#homebrew">Homebrew</a></h4>
<p>Install the build system dependencies:</p>
<pre><code class="language-sh">brew install automake bison gettext libtool make nasm gcc@7 \
gcc-7 pkg-config cmake ninja po4a macfuse findutils texinfo \
openssl@1.1 openssl@3.0 autoconf curl wget flex gperf expat \
gmp libpng jpeg sdl12-compat sdl2_ttf perl libtool m4 ninja \
meson python@3.11 zip unzip llvm doxygen gpatch automake scons \
lua ant protobuf redox-os/gcc_cross_compilers/x86_64-elf-gcc x86_64-elf-gcc
</code></pre>
<ul>
<li>If you want to use QEMU, run:</li>
</ul>
<pre><code class="language-sh">brew install qemu qemu-system-x86_64
</code></pre>
<ul>
<li>If you want to use VirtualBox, run:</li>
</ul>
<pre><code class="language-sh">brew install virtualbox
</code></pre>
<p>If you have some problem, try to install this Perl module:</p>
<pre><code class="language-sh">cpan install HTML::Entities
</code></pre>
<h2 id="install-rust-stable-and-nightly"><a class="header" href="#install-rust-stable-and-nightly">Install Rust Stable And Nightly</a></h2>
<p>Install Rust, make the nightly version your default toolchain, list the installed toolchains, then install more Rust tooling:</p>
<pre><code class="language-sh">curl https://sh.rustup.rs -sSf | sh
</code></pre>
<p>then</p>
<pre><code class="language-sh">source ~/.cargo/env
</code></pre>
<pre><code class="language-sh">rustup default nightly
</code></pre>
<pre><code class="language-sh">rustup toolchain list
</code></pre>
<pre><code class="language-sh">cargo install cbindgen just
</code></pre>
<p>The <code>. "$HOME/.cargo/env</code> command (equivalent to <code>source ~/.cargo/env</code>) have been added to your shell start-up file, <code>~/.bashrc</code>, but you may wish to add it elsewhere or modify it according to your own environment.</p>
<h2 id="customizing-c-compiler"><a class="header" href="#customizing-c-compiler">Customizing C compiler</a></h2>
<p>Redox requires a GCC-compatible compiler for the operating system to build additional host tools. GCC for the host system is searched automatically from <code>PATH</code> environment variable with a binary named as <code>$GNU_TARGET-gcc</code> (e.g. <code>x86_64-linux-gnu-gcc</code>).</p>
<p>If your operating system is not Linux or if you want to use a different compiler, you can export <a href="https://gitlab.redox-os.org/redox-os/redoxer#host-specific-customizations">more environment variables</a> in the <code>.config</code> file:</p>
<pre><code class="language-sh">export REDOXER_HOST_AR=ar
export REDOXER_HOST_AS=as
export REDOXER_HOST_CC=cc
export REDOXER_HOST_CXX=c++
export REDOXER_HOST_LD=ld
export REDOXER_HOST_NM=nm
export REDOXER_HOST_OBJCOPY=objcopy
export REDOXER_HOST_OBJDUMP=objdump
export REDOXER_HOST_PKG_CONFIG=pkg-config
export REDOXER_HOST_RANLIB=ranlib
export REDOXER_HOST_READELF=readelf
export REDOXER_HOST_STRIP=strip
</code></pre>
<blockquote>
<p>üìù <strong>Note:</strong> FreeBSD and MacOS default compiler is Clang, so their support is experimental as also using a GCC version other than 14.x (i.e. the GCC version in Debian 13). Try to set these environment variables if you find any issues in any recipe compilation.</p>
</blockquote>
<h2 id="prefix"><a class="header" href="#prefix">Prefix</a></h2>
<p>In addition to build tools from the system, building Redox requires additional compilers and tools bootstrapped from your host compilers:</p>
<ul>
<li>GCC</li>
<li>GNU Binutils</li>
<li>libtool</li>
<li>Rust</li>
<li>Relibc</li>
</ul>
<p>The tools that build Redox are specific to each CPU architecture. These tools are located in the directory <code>prefix</code>, in a subdirectory named for the architecture, e.g. <code>prefix/x86_64-unknown-redox</code>. If you have problems with these tools, you can remove the subdirectory or even the whole <code>prefix</code> directory, which will cause the tools to be re-downloaded or rebuilt. The variable <code>PREFIX_BINARY</code> in <code>mk/config.mk</code> controls whether they are downloaded or built.</p>
<h3 id="prebuilt-prefix"><a class="header" href="#prebuilt-prefix">Prebuilt Prefix</a></h3>
<p>Redox provides a <a href="https://static.redox-os.org/toolchain/">prebuilt prefix toolchain</a> to make building fast. The prebuilt prefix is only suitable for use inside Podman requiring glibc version 2.41 or newer (as the Podman Build container is based on Debian 13) and not all CPU compiler targets are available for ARM-based Linux.</p>
<p>If your Linux distribution is not using glibc or its version is older than 2.41, you need to set <code>PREFIX_BINARY=0</code> and build your own prefix toolchain.</p>
<h3 id="prefix-gcc"><a class="header" href="#prefix-gcc">Prefix: GCC</a></h3>
<p>Redox compiles its own GCC, GNU Binutils and Libtool to create a cross-compilation target to Redox. The whole build takes about a half hour or less if your hardware is relatively powerful. When it's completed it generates the <code>gcc-install</code> directory containing these cross-compilers.</p>
<h3 id="prefix-rust"><a class="header" href="#prefix-rust">Prefix: Rust</a></h3>
<p>Redox OS is listed as both Tier 2 and Tier 3 <a href="https://doc.rust-lang.org/nightly/rustc/platform-support/redox.html">platform support</a> on Rust. The x86_64 architecture is listed as Tier 2 target which means that Rust's libstd is available for this target.</p>
<p>Redox compiles its own Rust compiler to be able to build Tier 3 libstd. Fortunately, we can choose to download from rustup instead of building the Rust compiler using the environment variable: <code>PREFIX_USE_UPSTREAM_RUST_COMPILER</code> in <code>mk/config.mk</code>.</p>
<p>Building Rust takes about 2 hours or more (if your hardware is relatively powerful) as it's also needed to compile LLVM. If you are building for the x86_64 target, downloading Rust from rustup (the official Rust binaries) might be preferable. When it's completed it generates the <code>rust-install</code> directory containing both GCC and Rust compiler.</p>
<p>Note that there maybe some patches in <a href="https://gitlab.redox-os.org/redox-os/rust/">Redox Rust fork</a> that has not been upstreamed, so your experience with using Rust from rustup might be different than building it.</p>
<h3 id="prefix-relibc"><a class="header" href="#prefix-relibc">Prefix: Relibc</a></h3>
<p><a href="https://gitlab.redox-os.org/redox-os/relibc">Relibc</a> is the <a href="https://en.wikipedia.org/wiki/C_standard_library">C standard library</a> written for Redox. Relibc is needed for both GCC and Rust to compile programs.</p>
<p>Relibc is very active in development even with <code>PREFIX_BINARY=1</code> it will be compiled anyway so we always have the updated libc. Fortunately, compiling it is very quick. When it's completed it generates the <code>relibc-install</code> directory containing GCC and Rust bundled with updated relibc.</p>
<h2 id="cookbook"><a class="header" href="#cookbook">Cookbook</a></h2>
<p>The <strong>Cookbook</strong> system is an essential part of the Redox build system. Each Redox component package  is built and managed by the Cookbook toolset. The variable <code>REPO_BINARY</code> in <code>mk/config.mk</code> controls if the recipes are compiled from sources or use binary packages from Redox CI server, read the section <a href="./configuration-settings.html#repo_binary">REPO_BINARY</a> for more details. See the <a href="./including-programs.html">Including Programs in Redox</a> page for examples of using the Cookbook toolset. If you will be developing recipes to include in Redox.</p>
<h2 id="creating-a-build-environment-shell"><a class="header" href="#creating-a-build-environment-shell">Creating a Build Environment Shell</a></h2>
<p>If you are working on specific components of the system, and will be using some of the tools in the <code>redox</code> directory and bypassing <code>make</code>, you may wish to create a build environment shell. This shell includes the <code>prefix</code> tools in your <code>PATH</code>. You can do this with:</p>
<pre><code class="language-sh">make env
</code></pre>
<p>This command also works with a Podman Build, creating a shell in Podman and setting <code>PATH</code> to include the necessary build tools.</p>
<h2 id="updating-the-sources"><a class="header" href="#updating-the-sources">Updating The Sources</a></h2>
<p>If you want to update the build system or if some of the recipes have changed, you can update those parts of the system with <code>make pull</code>. However, this will not update the sources of the recipes.</p>
<pre><code class="language-sh">cd ~/tryredox/redox
</code></pre>
<pre><code class="language-sh">make pull
</code></pre>
<p>If you want to update the source for the recipes, use <code>make rebuild</code>, or remove the file <code>$(BUILD)/fetch.tag</code> and run <code>make fetch</code></p>
<h2 id="changing-the-filesystem-size-and-contents"><a class="header" href="#changing-the-filesystem-size-and-contents">Changing the Filesystem Size and Contents</a></h2>
<p>You can modify the size and contents of the filesystem for emulation and <em>livedisk</em> as described in the <a href="./configuration-settings.html">Configuration Settings</a> page.</p>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<p>Once this is all set up, we can finally build! See the <a href="./building-redox.html#compiling-redox">Compiling Redox</a> section.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="advanced-podman-build.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="i686.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="advanced-podman-build.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="i686.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
